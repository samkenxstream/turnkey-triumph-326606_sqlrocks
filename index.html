<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>sqlrocks</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="sqlrocks - transparent, schemaless library for building and composing SQL statements">
    <meta name="keywords" content="sqlrocks, sql, lua, luarocks, rock, mysql, sqlite, simbio.se">
    <meta name="author" content="francisco leite">

    <link rel="stylesheet" href="https://googledrive.com/host/0B5JFsUrZerb_ZkNhU1ZNMERMQmc/bootstrap.min.css" media="screen">
    <link rel="stylesheet" href="https://googledrive.com/host/0B5JFsUrZerb_VTRNbWJ4NU5NOTg/readable.css">
    <link rel="stylesheet" href="https://googledrive.com/host/0B5JFsUrZerb_X20wRHpfYW5IckE/prism.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://googledrive.com/host/0B5JFsUrZerb_UVRkZ3hPbGdLWE0/html5shiv.js"></script>
      <script src="https://googledrive.com/host/0B5JFsUrZerb_ek9aQ3JLX3Z0X2M/respond.js"></script>
    <![endif]-->
    <style type='text/css'>
      pre {
        overflow:visible;
        margin-bottom:16px;
        padding: 2px 4px !important;
        line-height:12px;
        white-space: pre-line;
      }
      pre::before {
        content:   attr(data-lang);
        position: relative;
        top:      -1em
      }
      pre > code {
        white-space: pre-line;
        width:      100%;
        overflow-x: auto;
        overflow-y: hidden;
        display:    block;
        line-height: 16px;
        text-align: left;
      }

      span.teletype {
        font-family: monospace;
        font-weight: normal;
        font-style: normal;
        padding: 2px 4px;
        font-size: 90%;
        color: #333;
        background-color: #ddd;
        border-radius: 2px;
      }
      .outer {width: 228px;}
      .outer > #sidebar {position: relative}
      #sidebar > ul {
        position: absolute;
        top: 0px;
        left: 0px;
        right: 0px;
        bottom: 0px;
        margin: auto;
      }

      .navbar-form input, .form-inline input {width:auto}
      b.header {font-size: 20px}
      b.header, p > code, span.alias {margin-right: 12px}
      p, pre[class] {margin-bottom: 16px}
      .license {line-height: 16px; border: 0px; font-size: 16px}

      @media (min-width: 979px) {
        #sidebar.affix-top, .outer.affix-top {
          position: static;
          margin-top:25px;
        }
  
        #sidebar.affix, .outer.affix {
          position: fixed;
          top:65px;
        }
      }
      .affix, .affix-top {position:static}

      #sidebar li > .nav {display:none}
      #sidebar li.active > .nav {display: block}
      #sidebar .nav > li > a {padding: 3px 6px}
      #sidebar li.active > .nav > li > a {
        padding: 2px 4px 2px 24px;
        border-radius: 3px
      }
      #sidebar li.active > .nav > li.active > a{
        color: #134fb8;
        text-decoration: none;
        background-color: #eeeeee
      }


    </style>
  </head>
  <body data-spy="scroll">

    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <label class="navbar-brand">sqlrocks</label>
        </div>
        <div class="navbar-collapse collapse" id="navbar-main">

          <ul class="nav navbar-nav">
            <li>
              <a href="https://github.com/simbiose/sqlrocks" >Fork me on GitHub</a>
            </li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="download">Download <span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="download">
                <li><a href="https://github.com/simbiose/sqlrocks/zipball/master">zip file</a></li>
                <li><a href="https://github.com/simbiose/sqlrocks/tarball/master">tar file</a></li>
                <li class="divider"></li>
                <li><a href="http://rocks.simbio.se/sqlrocks-0.1.rock">rock file</a></li>
              </ul>
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li><a href="http://bootswatch.com/" target="_blank">Theme from Bootswatch</a></li>
            <li><a href="http://builtwithbootstrap.com/" target="_blank">Built With Bootstrap</a></li>
          </ul>

        </div>
      </div>
    </div>


    <div class="container">

      <header class="page-header" id="banner">
        <div class="row">
          <div class="col-lg-9">
            <h1>sqlrocks</h1>
            <p class="lead">transparent, schemaless library for building and composing SQL statements</p>
          </div>
        </div>
      </header>

      <div class="row">

      <div id="documentation" class="col-md-9" role="main">

        <h1 id="introduction">Introduction</h1>

        <!-- <p><a href="https://travis-ci.org/CSNW/sql-bricks" title="Build Status"><img src="https://travis-ci.org/CSNW/sql-bricks.png?branch=master"></a></p> -->
        <p >As with other SQL generation libraries, SQL Rocks was created to help eliminate DRY violations in SQL-heavy applications.
        SQL statements can be easily stored, cloned, modified and passed around to other parts of an application and they can generate both parameterized and non-parameterized SQL.</p>
        <p>In addition, SQL Rocks contains a few conveniences to aid in re-use and to make SQL generation a little less of a chore: 
        automatic quoting of columns that collide with keywords (<span class="teletype" >order</span>, <span class="teletype" >desc</span>, etc), automatic 
        <a href="#aliasExpansions">alias expansion</a>, user-supplied <a href="#joinCriteria">join criteria</a> functions and <a href="#addView">pseudo-views</a>.</p>
        <p>SQL Rocks differs from similar libraries in that it does not require a schema and it is designed to be transparent, matching SQL so faithfully that developers with SQL experience will immediately know the API.</p>
        <p>SQL Rocks supports the four CRUD statements (<span class="teletype" >SELECT</span>, <span class="teletype" >INSERT</span>, <span class="teletype" >UPDATE</span>, <span class="teletype" >DELETE</span>) and all of their clauses as defined by <b>
        <a href="http://communities.progress.com/pcom/servlet/JiveServlet/download/11287-2-10624/s92.pdf">SQL-92</a></b> as well as some additional clauses supported by <b>Postgres</b> and <b>SQLite</b>. 
        Adding support for other SQL statements (<span class="teletype" >CREATE</span>, <span class="teletype" >ALTER TABLE</span>, etc) would clutter the library without providing much real benefit.</p>
        <p>The <a href="https://github.com/simbiose/sqlrocks">source</a> is on GitHub and over <a href="https://github.com/simbiose/sqlrocks/blob/master/tests/all.spec.lua">a hundred and fifty tests</a> are available for your perusal.</p>

        <h2 id="use">Use</h2>

        <p>SQL Rocks can be accessed with <span class="teletype" >require('sqlrocks')</span>. 
        Throughout this documentation, it is assumed that SQL Rocks instance is set to a local <span class="teletype" >sql</span> variable and that top-level functions are also set to local variables 
        (for example: <span class="teletype" >local select, insert, update, delete, _or, _in = sql.select, sql.insert, sql.update, sql.delete, sql._or, sql._in</span>).</p>
        <p>The API is designed to mirror SQL faithfully, with SQL keywords represented by chainable camelCase method and non-keywords passed as string arguments. 
        To make the API easier to use, objects can also be passed in wherever there are key/value pairs.</p>
        <pre>
          <code class="language-lua">
  select():from('users')
    :where(_or({last_name='Rubble'}, _in('first_name', {'Fred', 'Wilma', 'Pebbles'})))
  -- SELECT * FROM users
  -- WHERE last_name = 'Rubble' OR first_name IN ('Fred', 'Wilma', 'Pebbles')
          </code>
        </pre>

        <p id="sql">
          <b class="header">sql</b><code>sql.sql(str)</code>
        </p>

        <p>The SQL Rocks namespace (saved to the local variable <span class="teletype" >sql</span> in these docs) can be called as a function to insert SQL into SQL Rocks somewhere that a value is expected (the right-hand side of <span class="teletype" >WHERE</span> criteria, or <span class="teletype" >insert()</span>/<span class="teletype" >update()</span> values):</p>
        <pre>
          <code class="language-lua">
  select('*'):from('users'):where({billing_addr_id=sql.sql('mailing_addr_id')})
  -- SELECT * FROM users WHERE billing_addr_id = mailing_addr_id
          </code>
        </pre>

        <p id="val">
          <b class="header">val</b><code>sql.val(value)</code>
        </p>

        <p>Wraps a <b>value</b> (user-supplied string, number, boolean, etc) so that it can be passed into SQL Rocks anywhere that a column is expected (the left-hand side of <span class="teletype" >WHERE</span> criteria and many other SQL Rocks APIs):</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where(sql.val('Fred'), sql.sql('first_name'))
  -- SELECT * FROM users WHERE 'Fred' = first_name
          </code>
        </pre>

        <h2 id="statement">Statement</h2>

        <p><span class="teletype" >Statement</span> is an abstract base class for all statements (<span class="teletype" >SELECT, INSERT, UPDATE, DELETE</span>) and should never be instantiated directly. It is exposed because it can be used with the <span class="teletype" >:is(object)</span> operator to easily determine whether something is a SQL Rocks statement: <span class="teletype" >my_var:is(Statement)</span>.</p>

        <p id="clone">
          <b class="header">clone</b><code>stmt:clone()</code>
        </p>

        <p>Clones a statement so that subsequent modifications do not affect the original statement.</p>
        <pre>
          <code class="language-lua">
  local active_users = select('*'):from('users'):where({active=true})
  -- SELECT * FROM users WHERE active = true
  local local_users = active_users:clone():where({['local']=true})
  -- SELECT * FROM users WHERE active = true AND local = true
          </code>
        </pre>

        <p id="toString">
          <b class="header">__tostring</b><code>stmt:__tostring()</code><code>stmt:__concat(object)</code>
        </p>

        <p>Returns the non-parameterized SQL for the statement. This metamethod is called implicitly by Lua when using a Statement anywhere that a string is expected (string concatenation, <span class="teletype" >tostring(stmt)</span>, etc).</p>

        <p id="toParams">
          <b class="header">toParams</b><code>stmt:toParams(options)</code>
        </p>

        <p>Returns a table with two properties: a parameterized <span class="teletype" >text</span> string and a <span class="teletype" >values</span> table. The values are populated with anything on the right-hand side of a <span class="teletype" >WHERE</span> criteria, as well as any values passed into an <span class="teletype" >insert()</span> or <span class="teletype" >update()</span> (they can be passed explicitly with <span class="teletype" >val()</span> or opted out of with <span class="teletype" >sql.sql()</span>):</p>
        <pre>
          <code class="language-lua">
  update('users', {first_name='Fred'}):where({last_name='Flintstone'}):toParams()
  -- {text="UPDATE users SET first_name = $1 WHERE last_name = $2", values={"Fred", "Flintstone"}}
          </code>
        </pre>

        <p>A <span class="teletype" >placeholder</span> <b>option</b> of <span class="teletype" >'?'</span> can be passed to generate placeholders compatible with your favorite database client:</p>
        <pre>
          <code class="language-lua">
  update('users', {first_name='Fred'}):where({last_name='Flintstone'}):toParams({placeholder='?'})
  -- {text="UPDATE user SET first_name = ?1 WHERE last_name = ?2", values={"Fred", "Flintstone"}}
          </code>
        </pre>

        <h2 id="select">select</h2>
        <p id="selconstructor">
          <b class="header">constructor</b><code>select(columns)</code>
        </p>

        <p><span class="teletype" >sql.select()</span> returns a new select statement, seeded with a set of <b>columns</b>. It can be used with or without the <span class="teletype" >new</span> keyword. Columns can be passed in here (or appended later via <span class="teletype" >sel.select()</span> or <span class="teletype" >sel:distinct()</span>) via multiple arguments or a comma-delimited string or an array.</p>
        <p>If no <b>columns</b> are specified, <span class="teletype" >__tostring()</span> will default to <span class="teletype" >SELECT *</span>.</p>

        <p id="selselect">
          <b class="header">select</b><code>sel:select(columns)</code>
        </p>

        <p>Appends additional <b>columns</b> to an existing query. Columns can be passed as multiple arguments, a comma-delimited string or an array.</p>

        <p id="distinct">
          <b class="header">distinct</b><code>sel:distinct(columns)</code>
        </p>

        <p>Makes the query a <span class="teletype" >SELECT DISTINCT</span> query. For convenience, any <b>columns</b> passed will be appended to the query (they can be passed in the same ways as to <span class="teletype" >select()</span>).</p>

        <p id="into">
          <b class="header">into</b><code>sel:into(tbl)</code><span class="alias">Alias: <b>intoTable</b></span>
        </p>

        <p>Makes the query a <span class="teletype" >SELECT ... INTO</span> query (which creates a new table with the results of the query).</p>

        <p id="intoTemp">
          <b class="header">intoTemp</b><code>sel:intoTemp(tbl)</code><span class="alias">Alias: <b>intoTempTable</b></span>
        </p>

        <p>Does the same as <span class="teletype" >:into()</span>, but with the addition of the <span class="teletype" >TEMP</span> keyword, making it a temporary table.</p>

        <p id="selfrom">
          <b class="header">from</b><code>sel:from(tbls)</code>
        </p>

        <p>Table names can be passed in as multiple string arguments, a comma-delimited string or an array.</p>

        <p id="join">
          <b class="header">join, leftJoin, rightJoin, fullJoin, crossJoin</b><br><code>sel:join(tbl[, onCriteria])</code><br>
          <span class="alias">Aliases: <b>innerJoin, leftOuterJoin, rightOuterJoin, fullOuterJoin</b></span>
        </p>

        <p>Adds the specified join to the query. <b>tbl</b> can include an alias after a space or after the <span class="teletype" >'AS'</span> keyword (<span class="teletype" >'my_table my_alias'</span>). <b>onCriteria</b> is optional if a <a href="#joinCriteria">joinCriteria</a> function has been supplied.</p>
        <pre>
          <code class="language-lua">
  select():from('users'):join('address', {user.addr_id='address.id'})
  -- SELECT * FROM users INNER JOIN address ON user.addr_id = address.id
          </code>
        </pre>

        <p id="on">
          <b class="header">on</b><code>sel:on(onCriteria)</code>
        </p>

        <p><i>Note: <b>onCriteria</b> can also be passed as the second argument to <span class="teletype" >join</span>.</i></p>
        <pre>
          <code class="language-lua">
  select('*'):from('users'):innerJoin('address'):on('users.addr_id', 'address.id')
  -- SELECT * FROM users INNER JOIN address ON users.addr_id = address.id

  select('*'):from('users'):join('address'):on({user.addr_id='address.id'});
  -- SELECT * FROM users INNER JOIN address ON users.addr_id = address.id
          </code>
        </pre>

        <p id="selwhere">
          <b class="header">where</b><span class="alias">Alias: <b>_and</b></span><br>
          <code>sel:where(column, value)</code><br>
          <code>sel:where(criteria)</code><br>
          <code>sel:where(whereExpr)</code>
        </p>

        <p>Sets or extends the <span class="teletype" >WHERE</span> clause. If there already is a <span class="teletype" >WHERE</span> clause, the new criteria will be added to a top-level <span class="teletype" >AND</span> group.</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where('first_name', 'Fred')
  -- SELECT * FROM users WHERE first_name = 'Fred'

  select():from('users'):where('last_name', 'Flintstone'):_and('first_name', 'Fred')
  -- SELECT * FROM users WHERE last_name = 'Flintstone' AND first_name = 'Fred'
          </code>
        </pre>
        <p>Multiple key/value pairs in a <b>criteria</b> object are <span class="teletype" >AND</span>ed together:</p>
        <pre>
          <code class="language-lua">
  select('*'):from('users'):where({last_name='Flintstone', first_name='Fred'})
  -- SELECT * FROM users WHERE last_name = 'Flintstone' AND first_name = 'Fred'
          </code>
        </pre>
        <p>For nested groupings and for relational operators beyond <span class="teletype" >=</span>, a <a href="#whereexpr"><b>whereExpr</b></a> can be passed in:</p>
        <pre>
          <code class="language-lua">
  select('*'):from('users'):where(_or(like('last_name', 'Flint%'), {first_name= 'Fred'}))
  -- SELECT * FROM users WHERE last_name LIKE 'Flint%' OR first_name = 'Fred'
          </code>
        </pre>

        <p id="groupBy">
          <b class="header">groupBy</b><code>sel:groupBy(columns)</code>
          <span class="alias">Alias: <b>group</b></span>
        </p>

        <p>Sets or extends the <span class="teletype" >GROUP BY</span> columns. Can take multiple arguments, a single comma-delimited string or an array.</p>

        <p id="having">
          <b class="header">having</b><br>
          <code>sel:having(column, value)</code><br>
          <code>sel:having(criteria)</code><br>
          <code>sel:having(whereExpr)</code>
        </p>

        <p>Sets or extends the <span class="teletype" >HAVING</span> criteria. Like <span class="teletype" >where()</span>, it takes a <b>column</b> / <b>value</b> pair, a <b>criteria</b> object or a <a href="#whereexpr"><b>whereExpr</b></a>:</p>
        <pre>
          <code class="language-lua">
  select('city', 'max(temp_lo)'):from('weather')
    :groupBy('city'):having(lt('max(temp_lo)', 40))
  -- SELECT city, max(temp_lo) FROM weather
  -- GROUP BY city HAVING max(temp_lo) &lt; 40
          </code>
        </pre>

        <p id="union">
          <b class="header">(union, intersect, minus, except)[All]</b><code>sel:union([stmt, ...])</code>
        </p>

        <p>Creates a compound statement by fusing together two or more queries, returns the last statement. If no <b>stmt</b> is passed, a new <span class="teletype" >select()</span> will be created and returned:</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where({last_name='Flintstone'}):union()
    :select():from('users'):where({last_name='Rubble'})
  -- SELECT * FROM user WHERE last_name = 'Flintstone' UNION
  -- SELECT * FROM user WHERE last_name = 'Rubble'
          </code>
        </pre>

        <p id="orderBy">
          <b class="header">orderBy</b><code>sel:orderBy(columns)</code>
          <span class="alias">Alias: <b>order</b></span>
        </p>

        <p>Sets or extends the list of columns in the <span class="teletype" >ORDER BY</span> clause. Columns can be passed as multiple arguments, a single comma-delimited string or an array.</p>

        <p id="limit">
          <b class="header">limit</b><code>sel:limit(count)</code>
        </p>

        <p>Adds a <span class="teletype" >LIMIT</span> clause.</p>

        <p id="offset">
          <b class="header">offset</b><code>sel:offset(position)</code>
        </p>

        <p>Adds an <span class="teletype" >OFFSET</span> clause.</p>

        <p id="forUpdate">
          <b class="header">forUpdate, noWait</b><code>sel:forUpdate([tbl, ...]) / sel:noWait()</code>
        </p>

        <p>Add the <span class="teletype" >FOR UPDATE</span> clause to lock all selected records from all tables in the select (or just the tables specified), along with an optional <span class="teletype" >NO WAIT</span> at the end:</p>
        <pre>
          <code class="language-lua">
  select('addr_id'):from('users'):forUpdate('addr_id'):noWait()
  -- SELECT addr_id FROM users FOR UPDATE addr_id NO WAIT
          </code>
        </pre>

        <p id="joinView">
          <b class="header">joinView</b><code>sel:joinView(view_name[, onCriteria, join_type])</code>
        </p>

        <p>Joins to the main tables of the <a href="#addView">pseudo-view</a> and merges into the query all of the view's joins and where clauses (with joined tables prefixed by the view's alias).</p> 
        <p><b>view_name</b> can include an alias after a space or after the <span class="teletype" >AS</span> keyword (<span class="teletype" >'my_view my_alias'</span> or <span class="teletype" >'my_view AS my_alias'</span>). <b>onCriteria</b> is optional if a <a href="#joinCriteria">joinCriteria</a> function has been supplied. <b>join_type</b> defaults to <span class="teletype" >'inner'</span> and must be supplied for other types of joins.</p>
        <pre>
          <code class="language-lua">
  sql:addView('localUser',
      select():from('users')
        :join('address'):on({['user.addr_id']='address.id'})
        :where({['address.local']=true})
    )

  select():from('person')
    :joinView('localUser l_usr', {['person.usr_id']='l_usr.id'})
  -- SELECT * FROM person
  -- INNER JOIN users l_usr ON person.usr_id = l_usr.id
  -- INNER JOIN address l_usr_address ON l_usr.addr_id = l_usr_address.id
  -- WHERE l_usr_address.local = true
          </code>
        </pre>

        <h2 id="insert">insert</h2>

        <p id="insconstructor">
          <b class="header">constructor</b><span class="alias">Alias: <b>insertInto</b></span>
          <code>insert(tbl[, values])</code><br>
          <code>insert(tbl[, columns])</code>
        </p>

        <p><span class="teletype" >sql.insert()</span> returns a new <span class="teletype" >INSERT</span> statement. It can be used with or without the <span class="teletype" >new</span> operator.</p>
        <pre>
          <code class="language-lua">
  insert('users', {first_name='Fred', last_name='Flintstone'})
  -- INSERT INTO user (first_name, last_name) VALUES ('Fred', 'Flintstone')
          </code>
        </pre>

        <p>It can take a <b>values</b> object or a <b>columns</b> list. Passing a set of columns (as multiple arguments, a comma-delimited string or an array) will put the statement into <span class="teletype" >split keys/values</span> mode, where a matching array of values is expected in <span class="teletype" >values()</span>:</p>
        <pre>
          <code class="language-lua">
  insertInto('users', 'first_name', 'last_name'):values('Fred', 'Flintstone')
  -- INSERT INTO users (first_name, last_name) VALUES ('Fred', 'Flintstone')
          </code>
        </pre>

        <p id="insorReplace">
          <b class="header">orReplace, orRollback, orAbort, orFail, orIgnore</b>
          <code>ins:orReplace(), ins:orRollback(), ins:orAbort(), ins:orFail(), ins:orIgnore()</code>
        </p>

        <p>Adds appropriate SQLite/MySQL clause to the <span class="teletype" >INSERT</span> statement:</p>
        <pre>
          <code class="language-lua">
  insert():orReplace():into('users'):values({first_name='Fred', id=33})
  -- INSERT OR REPLACE INTO users (first_name, id) VALUES ('Fred', 33)
          </code>
        </pre>

        <p id="ininto">
          <b class="header">into</b><code>ins:into(tbl)</code>
        </p>

        <p><span class="teletype" >insertInto()</span> (or the shorter alias <span class="teletype" >insert()</span>) is preferred over <span class="teletype" >insert():into()</span>. <span class="teletype" >:into()</span> is kept as a way to match the SQLite dialect <span class="teletype" >INSERT OR REPLACE INTO</span>:</p>
        <pre>
          <code class="language-lua">
  insert():orReplace():into('users'):values({first_name='Fred', last_name='Flintstone'})
  -- INSERT OR REPLACE INTO users (first_name, last_name) VALUES ('Fred', 'Flintstone')
          </code>
        </pre>

        <p id="values">
          <b class="header">values</b><code>ins:values(values)</code>
        </p>

        <p><b>values</b> can be an object of key/value pairs or a set of values matching a set of keys passed into <span class="teletype" >insert()</span>:</p>
        <pre>
          <code class="language-lua">
  insertInto('users', 'first_name', 'last_name'):values('Fred', 'Flintstone')
  -- INSERT INTO users (first_name, last_name) VALUES ('Fred', 'Flintstone')

  insertInto('users'):values({first_name='Fred', last_name='Flintstone'})
  -- INSERT INTO users (first_name, last_name) VALUES ('Fred', 'Flintstone')
          </code>
        </pre>
        <p><i>Note: <b>values</b> can also be passed as the second argument to <span class="teletype" >insert()</span>.</i></p>

        <p id="insselect">
          <b class="header">select</b><code>ins:select(columns)</code>
        </p>

        <p>Returns a new <span class="teletype" >SELECT</span> statement that is connected to the <span class="teletype" >INSERT</span> statement, allowing chaining of select methods. When <span class="teletype" >__tostring() / toParams()</span> is called, it will render them both statements together as an <span class="teletype" >INSERT INTO ... SELECT</span> statement.</p>
        <p>Note that if you want to call a method on the insert object, you have to save a reference to it before calling <span class="teletype" >select()</span>, since <span class="teletype" >select()</span> returns a reference to a child Select statement instead of the parent Insert statement.</p>

        <p id="returning">
          <b class="header">returning</b><code>ins:returning(columns)</code>
        </p>

        <p>Adds a <span class="teletype" >RETURNING</span> clause to the <span class="teletype" >INSERT</span> statement.</p>
        <pre>
          <code class="language-lua">
  local ins = insert('user', 'first_name, last_name')
  ins:select('first_name, last_name'):from('account')
  ins:returning('account.pk');
  -- INSERT INTO user (first_name, last_name)
  -- SELECT first_name, last_name
  -- FROM account
  -- RETURNING account.pk
          </code>
        </pre>

        <h2 id="update">update</h2>

        <p id="updconstructor">
          <b class="header">constructor</b><code>update(tbl[, values])</code>
        </p>

        <p><span class="teletype" >sql:update()</span> returns a new <span class="teletype" >UPDATE</span> statement. It can be used with or without the <span class="teletype" >new</span> operator.</p>
        <pre>
          <code class="language-lua">
  update('user', {first_name='Fred', last_name='Flintstone'})
  -- UPDATE user SET first_name = 'Fred', last_name = 'Flintstone'
          </code>
        </pre>

        <p id="updorReplace">
          <b class="header">orReplace, orRollback, orAbort, orFail, orIgnore</b>
          <code>upd:orReplace(), upd:orRollback(), upd:orAbort(), upd:orFail(), upd:orIgnore()</code>
        </p>

        <p>Adds appropriate SQLite/MySQL clause to the <span class="teletype" >UPDATE</span> statement:</p>
        <pre>
          <code class="language-lua">
  update('user'):orReplace():set({first_name='Fred', id=33})
  -- UPDATE OR REPLACE user SET first_name = 'Fred', id = 33
          </code>
        </pre>

        <p id="set">
          <b class="header">set</b><span class="alias">Alias: <b>values</b></span><br>
          <code>upd:set(column, value)</code><br>
          <code>upd:set(values)</code>
        </p>

        <p>Sets or extends the values of the <span class="teletype" >UPDATE</span> statement with a <b>column, value</b> pair or a <b>values</b> object.</p>
        <pre>
          <code class="language-lua">
  update('users'):set('first_name', 'Fred'):set('last_name', 'Flintstone')
  -- UPDATE users SET first_name = 'Fred', last_name = 'Flintstone'

  update('users'):set({first_name='Fred', last_name='Flintstone'})
  -- UPDATE users SET first_name = 'Fred', last_name = 'Flintstone'
          </code>
        </pre>
        <p><i>Note: <b>values</b> can also be passed as the second argument to <span class="teletype" >update()</span>.</i></p>

        <p id="updwhere">
          <b class="header">where</b><span class="alias">Alias: <b>_and</b></span><br>
          <code>upd:where(column, value)</code><br>
          <code>upd:where(criteria)</code><br>
          <code>upd:where(whereExpr)</code>
        </p>

        <p>Sets or extends the <span class="teletype" >WHERE</span> clause. See <a href="#selwhere">select:where()</a> for more details.</p>

        <h2 id="delete">delete</h2>

        <p id="delconstructor">
          <b class="header">constructor</b><code>delete(tbl)</code><span class="alias">Alias: <b>deleteFrom</b></span>
        </p>

        <p><span class="teletype" >sql:delete()</span> returns a new <span class="teletype" >DELETE</span> statement. It can be used with or without the <span class="teletype" >new</span> operator.</p>

        <p id="delfrom">
          <b class="header">from</b><code>del:from(tbl)</code>
        </p>

        <p>Convenience method to make the delete API match the select API more closely.</p>

        <p id="using">
          <b class="header">using</b><code>del:using(tbl[, ...])</code>
        </p>

        <p>Sets or extends the list of tables in the <span class="teletype" >USING</span> clause. This is <span class="teletype" >DELETE</span>'s equivalent of <span class="teletype" >SELECT</span>'s multi-table <span class="teletype" >FROM</span> clause.</p>

        <p id="delwhere">
          <b class="header">where</b><span class="alias">Alias: <b>_and</b></span><br>
          <code>del:where(column, value)</code><br>
          <code>del:where(criteria)</code><br>
          <code>del:where(whereExpr)</code>
        </p>

        <p>Sets or extends the <span class="teletype" >WHERE</span> clause. See <a href="#selwhere">select:where()</a> for more details.</p>

        <h2 id="whereexpr">Where Expressions</h2>

        <p id="object">
          <b class="header">Object</b><code>{ ... }</code>
        </p>

        <p>When a non-expression object is passed somewhere a <span class="teletype" >whereExpression</span> is expected, each key/value pair will be <span class="teletype" >AND</span>ed together:</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where({first_name='Fred', last_name='Flintstone'})
  -- SELECT * FROM users WHERE first_name = 'Fred' AND last_name = 'Flintstone'
          </code>
        </pre>

        <p id="and">
          <b class="header">_and</b><code>_and(whereExpr[, ...])</code>
        </p>

        <p>Joins the passed expressions with <span class="teletype" >AND</span></p>

        <p id="or">
          <b class="header">_or</b><code>_or(whereExpr[, ...])</code>
        </p>

        <p>Joins the passed expressions with <span class="teletype" >OR</span>:</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where(_or(like('last_name', 'Flint%'), {first_name='Fred'}))
  -- SELECT * FROM users WHERE last_name LIKE 'Flint%' OR first_name = 'Fred'
          </code>
        </pre>
        <p>An object with multiple key/value pairs will generate an <span class="teletype" >OR</span>:</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where(_or({first_name='Fred', last_name='Rubble'}))
  -- SELECT * FROM users WHERE first_name = 'Fred' OR last_name = 'Rubble'
          </code>
        </pre>

        <p id="not">
          <b class="header">_not</b><code>_not(whereExpr)</code>
        </p>

        <p>Negates the expression by wrapping it in <span class="teletype" >NOT (...)</span> (if it is at the top level, the parentheses are unnecessary and will be omitted):</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where(_not(_in('name', {'Fred', 'Barney', 'Wilma', 'Pebbles'})))
  -- SELECT * FROM users WHERE NOT name IN ('Fred', 'Barney', 'Wilma', 'Pebbles')
          </code>
        </pre>

        <p id="eq">
          <b class="header">eq, notEq, lt, le, gt, ge</b><br>
          <code>eq(column, value)</code><br>
          <code>notEq(column, value)</code><br>
          <code>lt(column, value)</code><br>
          <code>le(column, value)</code><br>
          <code>gt(column, value)</code><br>
          <code>ge(column, value)</code>
        </p>

        <p>Generates the appropriate relational operator (<span class="teletype" >=</span>, <span class="teletype" >&lt;&gt;</span>, <span class="teletype" >&lt;</span>, <span class="teletype" >&lt;=</span>, <span class="teletype" >&gt;</span> or <span class="teletype" >&gt;=</span>).</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where(gt('access', 5))
  -- SELECT * FROM users WHERE access &gt; 5
          </code>
        </pre>

        <p id="between">
          <b class="header">between</b><code>between(column, value1, value2)</code>
        </p>

        <p>Generates a <span class="teletype" >BETWEEN</span>:</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where(between('access', 1, 5));
  -- SELECT * FROM users WHERE access BETWEEN 1 AND 5
          </code>
        </pre>

        <p id="isNull">
          <b class="header">isNull, isNotNull</b><code>isNull(column), isNotNull(column)</code>
        </p>

        <p>Generates <span class="teletype" >IS NULL</span> and <span class="teletype" >IS NOT NULL</span> expressions:</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where(isNull('name'));
  -- SELECT * FROM users WHERE name IS NULL
          </code>
        </pre>

        <p id="like">
          <b class="header">like</b><code>like(column, value)</code>
        </p>

        <p>Generates a <span class="teletype" >LIKE</span> expression.</p>
        <pre>
          <code class="language-lua">
  select('*'):from('user'):where(_or(like('last_name', 'Flint%'), {first_name='Fred'}))
  -- SELECT * FROM user WHERE last_name LIKE 'Flint%' OR first_name = 'Fred'
          </code>
        </pre>

        <p id="exists">
          <b class="header">exists</b><code>exists(stmt)</code>
        </p>

        <p>Takes a <b>stmt</b> subquery and generates an <span class="teletype" >EXISTS</span> expression:</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where(
      exists(select():from('address')
        :where({['address.id']=sql.sql('user.addr_id')})
      )
    )
  -- SELECT * FROM users WHERE EXISTS
  -- (SELECT * FROM address WHERE address.id = user.addr_id)
          </code>
        </pre>

        <p id="in">
          <b class="header">_in</b><br>
          <code>_in(column, values)</code><br>
          <code>_in(column, stmt)</code>
        </p>

        <p>Generates an <span class="teletype" >IN</span> expression based on a set of <b>values</b> (can be an array or multiple arguments) or a <b>stmt</b> subquery:</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where(_in('first_name', 'Fred', 'Barney', 'Wilma'))
  -- SELECT * FROM users WHERE first_name IN ('Fred', 'Barney', 'Wilma')

  select():from('users'):where(_in('addr_id', select('id'):from('address')))
  -- SELECT * FROM users WHERE addr_id IN (SELECT id FROM address)
          </code>
        </pre>

        <p id="eqAll">
          <b class="header">eqAll, notEqAll, ltAll, leAll, gtAll, geAll</b><br>
          <code>eqAll(stmt), notEqAll(stmt), ltAll(stmt), leAll(stmt), gtAll(stmt), geAll(stmt)</code>
        </p>

        <p>Pairs the appropriate relational operator with the <span class="teletype" >ALL</span> keyword.</p>

        <p id="eqAny">
          <b class="header">eqAny, notEqAny, ltAny, leAny, gtAny, geAny</b><br>
          <code>eqAny(stmt), notEqAny(stmt), ltAny(stmt), leAny(stmt), gtAny(stmt), geAll(stmt)</code>
        </p>

        <p>Pairs the appropriate relational operator with the <span class="teletype" >ANY</span> keyword:</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where(eqAny('users.id', select('user_id'):from('address')))
  -- SELECT * FROM users WHERE users.id = ANY (SELECT user_id FROM address)
          </code>
        </pre>

        <h2 id="conveniences">Conveniences</h2>

        <p id="aliasExpansions">
          <b class="header">aliasExpansions</b><code>sql.aliasExpansions(expansions)</code>
        </p>

        <p>Registers a set of frequently-used table aliases with SQL Rocks. These table aliases can then be used by themselves in <span class="teletype" >from()</span>, <span class="teletype" >join()</span>, etc and SQL Rocks will automatically expand them to include the table name as well as the alias:</p>
        <pre>
          <code class="language-lua">
  sql.aliasExpansions({usr='users', addr='address', zip='zipcode', psn='person'})

  select():from('usr'):join('addr', {['usr.addr_id']='addr.id'})
  -- SELECT * FROM users usr INNER JOIN address addr ON usr.addr_id = addr.id
          </code>
        </pre>

        <p id="joinCriteria">
          <b class="header">joinCriteria</b><code>sql.joinCriteria(func)</code>
        </p>

        <p>Sets a user-supplied function to automatically generate the <span class="teletype" >:on()</span> criteria for joins whenever it is not supplied explicitly:</p>
        <pre>
          <code class="language-lua">
  local alias = {users='usr', address='addr', zipcode='zip', person='psn'}
  sql.joinCriteria(function(l_tbl, l_alias, r_tbl, r_alias)
    return {
      [format('%s.%s_id', l_alias, alias[r_tbl])] = format('%s.id', r_alias)
    }
  })

  select():from('users'):join('address');
  -- SELECT * FROM users INNER JOIN address ON user.addr_id = address.id
          </code>
        </pre>

        <p>The <b>left_tbl</b> passed to the join criteria generator function will always be the most recently used table -- either the most recently joined table or, if there is none, the main table in the statement. If you want to perform a "chain" of joins, where each table joins from the previous one, you can call <span class="teletype" >:join()</span> multiple times, but if you want to join from one table directly to a number of related tables, you can call <span class="teletype" >:join()</span> once and pass the table names in as separate arguments:</p>
        <pre>
          <code class="language-lua">
  select():from('usr'):join('addr'):join('zip')
  -- SELECT * FROM users usr
  -- INNER JOIN address addr ON usr.addr_id = addr.id
  -- INNER JOIN zipcode zip ON addr.zip_id = zip.id

  select():from('usr'):join('addr', 'psn')
  -- SELECT * FROM user usr
  -- INNER JOIN address addr ON usr.addr_id = addr.id
  -- INNER JOIN person psn ON usr.psn_id = psn.id
          </code>
        </pre>

        <p>If multiple tables are passed to <span class="teletype" >:join()</span>, the last one is the most recently used one and it will be used as the basis for the next <span class="teletype" >:join()</span>:</p>
        <pre>
          <code class="language-lua">
  select():from('usr'):join('psn', 'addr'):join('zip');
  -- SELECT * FROM user usr
  -- INNER JOIN person psn ON usr.psn_id = psn.id
  -- INNER JOIN address addr ON usr.addr_id = addr.id
  -- INNER JOIN zipcode zip ON addr.zip_id = zip.id
          </code>
        </pre>

        <p>Note that this scheme doesn't support complex JOIN table layouts: if you do something like <span class="teletype" >:join('psn', 'addr'):join('zip')</span> above, it is impossible to also join something to the <span class="teletype" >'psn'</span> table. This <i>could</i> be achieved by adding a way to explicitly specify the table you're joining from: <span class="teletype" >:join('psn', 'addr'):join('zip'):join('psn-&gt;employer')</span>, but this hasn't been implemented.</p>

        <p id="addView">
          <b class="header">addView</b><code>sql.addView(stmt)</code>
        </p>

        <p>For those databases where native views have performance issues (SQLite and MySQL, for instance), sql-bricks provides pseudo-views. (Native views are treated as subqueries in SQLite; see the "Subquery Flattening" section of <a href="http://www.sqlite.org/optoverview.html">the SQLite Query Planner</a> for an idea of the performance problems.)</p>
        <p>The <b>stmt</b> that will be saved as a pseudo-view must consists of a main table and, optionally, join tables and where criteria. Queries can then join to this pseudo-view via <a href="#joinView">joinView()</a>.</p>

        <p id="getView">
          <b class="header">getView</b><code>sql.getView()</code>
        </p>

        <p>Returns a view that has been previously registered with <span class="teletype" >addView()</span> so that it can be used directly or cloned and modified:</p>
        <pre>
          <code class="language-lua">
  sql.addView('activeUsers', select():from('usr'):where({['usr.active']=true}))

  sql.getView('activeUsers'):clone():where({['usr.local']=true})
  -- SELECT * FROM user usr WHERE usr.active = true AND usr.local = true
          </code>
        </pre>

        <h2 id="sqlfunctions">SQL Functions</h2>
        
        <p>There are 95 SQL functions defined in SQL-92, including <span class="teletype" >AVG()</span>, <span class="teletype" >COUNT()</span>, <span class="teletype" >MIN()</span>, <span class="teletype" >MAX()</span>, <span class="teletype" >SUM()</span>, <span class="teletype" >COALESCE()</span>, <span class="teletype" >CASE()</span>, <span class="teletype" >LTRIM()</span>, <span class="teletype" >RTRIM()</span>, <span class="teletype" >UPPER()</span> and <span class="teletype" >LOWER()</span>, among others. These can be easily used in SQL Rocks anywhere that a sql string is expected, such as in a SELECT list:</p>
        <pre>
          <code class="language-lua">
  select('COUNT(*)'):from('user'):where({access_level=3})
  -- SELECT COUNT(*) FROM user WHERE access_level = 3
          </code>
        </pre>

        <p>SQL functions can also be used anywhere a value is expected (in the values for an <span class="teletype" >INSERT</span> or <span class="teletype" >UPDATE</span> or in the right-hand side of a <span class="teletype" >WHERE</span> expression) via wrapping a string in the <span class="teletype" >sql.sql()</span> function:</p>
        <pre>
          <code class="language-lua">
  select():from('users'):where({
    level_text =
      sql.sql("CASE WHEN level=1 THEN 'one' WHEN level=2 THEN 'two' ELSE 'other' END")
  })
  -- SELECT * FROM users WHERE level_text =
  -- CASE WHEN level=1 THEN 'one' WHEN level=2 THEN 'two' ELSE 'other' END
          </code>
        </pre>

        <p>Note that column names inside SQL functions that collide with SQL keywords will not be automatically escaped -- you have to do it manually, like this:</p>
        <pre>
          <code class="language-lua">
  select('COUNT("order")'):from('users')
  -- SELECT COUNT("order") FROM user
          </code>
        </pre>

        <h2 id="extending">Extending</h2>

        <p></p>
        <pre>
          <code class="language-lua">
            
          </code>
        </pre>
        <p></p>

        <h2 id="contributingAckLicense">Contributing, Acknowledgments and Licensing</h2>

        <p>Before sending a pull request, please verify that <a href="https://github.com/simbiose/sqlrocks/blob/master/tests/all.spec.lua">all the existing tests</a> pass and add new tests for the changes you are making. The tests can be run in console with <span class="teletype" >busted</span>. All of the examples in the documentation are run as tests.</p>
        <p>Note that <b>pull requests for additional SQL dialects</b> or extensions beyond ANSI SQL, Postgres and SQLite will probably not be merged. If you would like support for a different dialect, you are welcome to maintain a dialect-specific fork.</p>
        <p>Also, <b>pull requests for additional SQL statements</b> beyond the four CRUD statements (<span class="teletype" >SELECT</span>, <span class="teletype" >UPDATE</span>, <span class="teletype" >INSERT</span>, <span class="teletype" >DELETE</span>) will probably not be merged. Other SQL statements do not benefit as much from re-use and composition; the goal being to keep SQL Rocks small, sharp and low-maintenance.</p>

        <p>
          <b class="header">Acknowledgments</b>
        </p>

        <p>Thanks to <a href="https://github.com/CSNW">Cornerstone Systems</a>, <a href="https://github.com/prust">Peter Rust</a>, <a href="https://github.com/schuttsmcsnw">schuttsmcsnw</a> and everyone involved in <a href="https://github.com/CSNW/sql-bricks">sql-bricks</a> for inspiration in building this Lua port</p>
        <p>Also, thanks to <a href="https://github.com/Yonaba">Roland Y.</a> and his rock <a href="https://github.com/Yonaba/30log">30log</a> that helped me to create a similar model in SQL Rocks.</p>

        <p>
          <b class="header">License</b>
        </p>
        <pre class='license'>Copyright (c) 2014 Simbiose

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
        </pre>

        <br /><br />

      </div>

        <div class="col-md-3">
          <div class="outer affix-top">
            <div class="hidden-print" id="sidebar" role="complementary" style="position:relative;">
              <ul class="nav nav-pills nav-stacked">
                <li class="active"><a href="#introduction">Introduction</a></li>
                <li>
                  <a href="#use">Use</a>
                  <ul class="nav">
                    <li><a href="#sql">sql</a></li>
                    <li><a href="#val">val</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#statement">Statement</a>
                  <ul class="nav">
                    <li><a href="#clone">clone</a></li>
                    <li><a href="#toString">__tostring</a></li>
                    <li><a href="#toParams">toParams</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#select">Select</a>
                  <ul class="nav">
                    <li><a href="#selconstructor">constructor</a></li>
                    <li><a href="#selselect">select</a></li>
                    <li><a href="#distinct">distinct</a></li>
                    <li><a href="#into">into</a></li>
                    <li><a href="#intoTemp">intoTemp</a></li>
                    <li><a href="#selfrom">from</a></li>
                    <li><a href="#join">join, leftJoin, rightJoin, fullJoin, crossJoin</a></li>
                    <li><a href="#on">on</a></li>
                    <li><a href="#selwhere">where</a></li>
                    <li><a href="#groupBy">groupBy</a></li>
                    <li><a href="#having">having</a></li>
                    <li><a href="#union">(union, intersect, minus, except)[All]</a></li>
                    <li><a href="#orderBy">orderBy</a></li>
                    <li><a href="#limit">limit</a></li>
                    <li><a href="#offset">offset</a></li>
                    <li><a href="#forUpdate">forUpdate, noWait</a></li>
                    <li><a href="#joinView">joinView</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#insert">Insert</a>
                  <ul class="nav">
                    <li><a href="#insconstructor">constructor</a></li>
                    <li><a href="#insorReplace">orReplace, orRollback, orAbort, orFail, orIgnore</a></li>
                    <li><a href="#ininto">into</a></li>
                    <li><a href="#values">values</a></li>
                    <li><a href="#insselect">select</a></li>
                    <li><a href="#returning">returning</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#update">Update</a>
                  <ul class="nav">
                    <li><a href="#updconstructor">constructor</a></li>
                    <li><a href="#updorReplace">orReplace, orRollback, orAbort, orFail, orIgnore</a></li>
                    <li><a href="#set">set</a></li>
                    <li><a href="#updwhere">where</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#delete">Delete</a>
                  <ul class="nav">
                    <li><a href="#delconstructor">constructor</a></li>
                    <li><a href="#delfrom">from</a></li>
                    <li><a href="#using">using</a></li>
                    <li><a href="#delwhere">where</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#whereexpr">Where Expressions</a>
                  <ul class="nav">
                    <li><a href="#and">_and</a></li>
                    <li><a href="#or">_or</a></li>
                    <li><a href="#not">_not</a></li>
                    <li><a href="#eq">eq, notEq, lt, le, gt, ge</a></li>
                    <li><a href="#between">between</a></li>
                    <li><a href="#isNull">isNull, isNotNull</a></li>
                    <li><a href="#like">like</a></li>
                    <li><a href="#exists">exists</a></li>
                    <li><a href="#in">_in</a></li>
                    <li><a href="#eqAll">eqAll, notEqAll, ltAll, leAll, gtAll, geAll</a></li>
                    <!--<li><a href="#eqAny">eqAny, notEqAny, ltAny, leAny, gtAny, geAny</a></li>-->
                  </ul>
                </li>
                <li>
                  <a href="#conveniences">Conveniences</a>
                  <ul class="nav">
                    <li><a href="#aliasExpansions">aliasExpansions</a></li>
                    <li><a href="#joinCriteria">joinCriteria</a></li>
                    <li><a href="#addView">addView</a></li>
                    <li><a href="#getView">getView</a></li>
                  </ul>
                </li>
                <li><a href="#sqlfunctions">SQL Functions</a></li>
                <li><a href="#extending">Extending</a></li>
                <li><a href="#contributingAckLicense">Contributing, Acknowledgments and Licensing</a></li>
              </ul>
              <br style="clear:both" />
            </div>
          </div>
        </div>

      </div>

    

      <footer>
        <div class="row">
          <div class="col-lg-12">

          </div>
        </div>

      </footer>
      </div>

    </div>


    <script type="text/javascript" src="https://googledrive.com/host/0B5JFsUrZerb_dEtETmpJbHI1N28/jquery.js"></script>
    <script type="text/javascript" src="https://googledrive.com/host/0B5JFsUrZerb_dEtETmpJbHI1N28/bootstrap.js"></script>
    <script type="text/javascript" src="https://googledrive.com/host/0B5JFsUrZerb_dEtETmpJbHI1N28/prism.js" data-manual></script>
    
    <script type="text/javascript">
      var outerSidebar;
      var containerHeight = 0, windowHeight = 0;

      function onResize() {
        windowHeight = Math.max(window.innerHeight, document.documentElement.clientHeight) - 65;
        containerHeight = (windowHeight - 65);
        outerSidebar.height(windowHeight);
        outerSidebar.children().height(containerHeight);
      };

      window.onresize = onResize;
      outerSidebar = $('#sidebar').parent();
      outerSidebar.affix({offset:{top:$('header').height()}});

      $('a[href*=#]:not([href=#])').click(function() {
        if (
          location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') ||
          location.hostname == this.hostname
        ) {
          var target = $(this.hash);
          target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
          if (target.length) {
            $('html,body').animate({scrollTop: target.offset().top - 62}, 1000);
            return false;
          };
        };
      });

      Prism.highlightAll(false);

      (function(jQuery) {
        jQuery(document.body).scrollspy({target:"#sidebar", offset:68});
        jQuery(document.body).on('activate.bs.scrollspy', function () {
          var ul = $('ul.nav-stacked');
          ul.css({position: 'relative', height: 'auto'});
          var relative = parseInt(
              $('li.active:last').offset().top - outerSidebar.children().children().offset().top
            );
          var realHeight = ul.height();
          if(relative > (realHeight / 2)) {
            ul.css('height', relative + (realHeight / 2));
          } else if(realHeight > containerHeight) {
            ul.css('height', containerHeight);
          } else {
            ul.css('height', ul.height());
          };
          ul.css('position', 'absolute');
        });
        onResize();
      })($);
    </script>

    <!-- -->
    <script type="text/javascript">
      (function(i, s, o, g, r, a, m){
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments) 
          }, i[r].l = 1 * new Date();
        a        = s.createElement(o),
        m       = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src   = g;
        m.parentNode.insertBefore(a,m)
      })(window,document, 'script', '//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-43615637-1', 'simbio.se');
      ga('send', 'pageview');
    </script>

  </body>
</html>